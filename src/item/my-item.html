<link rel="import" href="../../bower_components/polymer/polymer.html"/>
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html"/>
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-icons/editor-icons.html"/>
<link rel="import" href="../../bower_components/iron-icons/image-icons.html"/>
<link rel="import" href="../../bower_components/iron-icons/communication-icons.html"/>
<dom-module id="my-item">
    <template>
        <style>
            paper-card {
                --paper-card-header-image: {
                    /*border-radius: 20%;*/
                };
                --paper-card-header-color: white;
            }

            .container {
                padding: 5px;
                background: #FFF;
                margin: 20px;
                float: left;
                box-shadow: 1px 1px 10px rgba(0, 0, 0, 0.4);
                -webkit-transition: box-shadow 2s, -webkit-transform 500ms, -webkit-filter 500ms ease-in-out;
                transition: box-shadow 2s, transform 500ms, filter 500ms ease-in-out;
            }

            .card-actions {
                display: flex;
                flex-direction: row;
            }

            .container:hover {
                -webkit-transform: scale(1.05);
                transform: scale(1.05);
                box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.6);
            }

            .blur {
                -webkit-filter: blur(3px);
                filter: blur(3px);
                filter: url(blur.svg#blur);
                -webkit-transform: scale(0.95);
                transform: scale(0.95);
            }
        </style>
        <div class="container">
            <paper-card heading="[[contact.login.username]]" image="[[contact.picture.large]]"
                        alt="[[contact.login.username]]" animatedShadow>
                <div class="card-content">
                    <p class="name">[[contact.name.first]]</p>
                    <p class="name">[[contact.name.last]]</p>
                </div>
                <div class="card-actions">
                    <paper-icon-button icon="info" id="info"></paper-icon-button>
                    <paper-icon-button icon="editor:mode-edit" id="edit"></paper-icon-button>
                    <paper-icon-button icon="delete" id="delete"></paper-icon-button>
                    <paper-icon-button icon="communication:call" id="call"></paper-icon-button>
                </div>
            </paper-card>
        </div>
    </template>
    <script>
        Polymer({
            is: 'my-item',
            properties: {
                contact: {
                    type: Object,
                    notify: true
                },
                contactSelected: {
                    type: Object,
                    notify: true
                },
            },
            /*
            * Add listener to hear click on submit button
            * */
            attached: function () {
                this.listen(this.$.info, 'tap', 'viewContact');
                this.listen(this.$.edit, 'tap', 'editContact');
                this.listen(this.$.delete, 'tap', 'deleteContact');
                this.listen(this.$.call, 'tap', 'callContact');
            },
            /*
            * Dispatch event to say about the view contact
            * */
            viewContact: function (event) {
                this.fire('view-contact', this.contact);
            },
            /*
            * Dispatch event to say about the edit contact
            * */
            editContact: function () {
                this.fire('edit-contact', this.contact);
            },
            /*
            * Dispatch event to say about the delete contact
            * */
            deleteContact: function () {
                if (confirm("Seguro que deseas eliminar al usuario: "+ this.contact.login.username)) {
                    this.fire('delete-contact', this.contact);
                } else {
                    console.log("Operacion cancelada");
                }
            },
            /*
            * Function to call a contact
            * */
            callContact: function(){
                window.open(
                    'https://appear.in/'+this.contact.login.username,
                    '_blank' // <- This is what makes it open in a new window.
                );
            },
            /*
            * Dispatch event to say about the more actions
            * */
            moreActions: function () {
                this.flag = !this.flag;
            },
            /*
            * Turn off the listener of click event
            * */
            detached: function () {
                this.unlisten(this.$.info, 'tap', 'viewContact');
                this.unlisten(this.$.edit, 'tap', 'editContact');
                this.unlisten(this.$.delete, 'tap', 'deleteContact');
                this.unlisten(this.$.call, 'tap', 'callContact');
            },
        });
    </script>
    </template>
</dom-module>
