<link rel="import" href="../../bower_components/polymer/polymer.html">
<dom-module id="my-profile">
    <template>
        <style>
            paper-card {
                margin: 20px;
                display: flex;
            }

            .image {
                border-radius: 20%;
                width: 300px;
                height: 280px;
                padding: 20px;
            }

            .name {
                text-transform: capitalize;
            }
        </style>
        <div class="container">
            <paper-card alt="[[contact.login.username]]" animatedShadow>
                <div>
                    <img class="image" src="[[contact.picture.large]]" alt="[[fullName]]">
                </div>
                <div class="body">
                    <div class="card-content">
                        <p class="name"><strong>Nombre: </strong>[[fullName]]</p>
                        <p><strong>Usuario: </strong> [[contact.login.username]]</p>
                        <p><strong>Sexo: </strong> [[contact.gender]]</p>
                        <p><strong>Dirección: </strong>[[fullAddress]]</p>
                        <p><strong>Correo electrónico: </strong>[[contact.email]]</p>
                        <p><strong>Fecha de nacimiento: </strong>[[contact.dob]]</p>
                        <p><strong>Teléfono: </strong>[[contact.phone]]</p>
                        <p><strong>Celular: </strong>[[contact.cell]]</p>
                        <p><strong>Nacionalidad: </strong>[[contact.nat]]</p>
                    </div>
                    <div class="card-actions">
                        <paper-icon-button icon="editor:mode-edit" id="edit" class="edit" on-tap="editContact">Editar</paper-icon-button>
                        <paper-icon-button icon="delete" id="delete" class="delete" on-tap="deleteContact">Eliminar</paper-icon-button>
                        <paper-icon-button icon="communication:call" id="iconCall" on-tap="callContact">Llamar</paper-icon-button>
                    </div>
                </div>

            </paper-card>
        </div>
    </template>
    <script>
        Polymer({
            is: 'my-profile',
            properties: {
                fullName: {
                    type: String,
                    computed: 'getFullName(contact.name.first, contact.name.last, contact.name.title)'
                },
                fullAddress: {
                    type: String,
                    computed: 'getFullAddress(contact.location.street, contact.location.postcode, contact.location.city, contact.location.state)'
                },
                contact: {
                    type: Object,
                }
            },
            attached: function () {
                this.listen(this.$.edit, 'tap', 'editContact');
                this.listen(this.$.delete, 'tap', 'deleteContact');
            },
            detached: function () {
                this.unlisten(this.$.edit, 'tap', 'editContact');
                this.unlisten(this.$.delete, 'tap', 'deleteContact');
            },
            getFullName: function (firstName, lastName, title) {
                var computedName = title + '. ' + firstName + ' ' + lastName;
                return computedName;
            },
            getFullAddress: function (street, postcode, city, state) {
                var computedAddress = street + ', ' + postcode + ', ' + city + ', ' + state;
                return computedAddress;
            },
            /*
            * Dispatch event to say about the delete contact
            * */
            deleteContact: function () {
                if (confirm("Seguro que deseas eliminar al usuario: "+ this.contact.login.username)) {
                    this.fire('delete-contact', this.contact);
                } else {
                    console.log("Operacion cancelada");
                }
            },
            /*
            * Dispatch event to say about the edit contact
            * */
            editContact: function () {
                this.fire('edit-contact', this.contact);
            },
            /*
            * Function to call a contact
            * */
            callContact: function(){
                window.open(
                    'https://appear.in/'+this.contact.login.username,
                    '_blank' // <- This is what makes it open in a new window.
                );
            },
        });
    </script>
</dom-module>
